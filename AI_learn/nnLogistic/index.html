
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="vllbc的个人网站">
      
      
      
        <meta name="author" content="vllbc">
      
      
        <link rel="canonical" href="https://vllbc.top/AI_learn/nnLogistic/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.6">
    
    
      
        <title>神经网络逻辑回归 - Vllbc的个人博客</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a57b2b03.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1-logistic" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Vllbc的个人博客" class="md-header__button md-logo" aria-label="Vllbc的个人博客" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Vllbc的个人博客
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              神经网络逻辑回归
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Vllbc的个人博客" class="md-nav__button md-logo" aria-label="Vllbc的个人博客" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Vllbc的个人博客
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        首页
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../2021-goal/goal/" class="md-nav__link">
        2021年目标
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          算法相关
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="算法相关" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          算法相关
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/" class="md-nav__link">
        介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/1/" class="md-nav__link">
        isbn号码
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/2/" class="md-nav__link">
        我做的第一个打表题
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/3/" class="md-nav__link">
        位运算的应用
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/4/" class="md-nav__link">
        位运算的应用(2)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/python_lq/" class="md-nav__link">
        python刷题
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/5/" class="md-nav__link">
        最小公众前缀
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/6/" class="md-nav__link">
        移除元素
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/7/" class="md-nav__link">
        有效的数独
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/8/" class="md-nav__link">
        旋转图像
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/9/" class="md-nav__link">
        去掉重复字母
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/10/" class="md-nav__link">
        字符串转整数
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/11/" class="md-nav__link">
        使用最小花费爬楼梯
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/12/" class="md-nav__link">
        最大子序和
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/13/" class="md-nav__link">
        打家劫舍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/14/" class="md-nav__link">
        外观数列
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/15/" class="md-nav__link">
        计数质数
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/16/" class="md-nav__link">
        分发饼干
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/17/" class="md-nav__link">
        按序打印
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/18/" class="md-nav__link">
        交换性别
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/19/" class="md-nav__link">
        打印零和奇偶数
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/20/" class="md-nav__link">
        零钱兑换
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/21/" class="md-nav__link">
        翻转二叉树
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/22/" class="md-nav__link">
        验证二叉搜索树
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/23/" class="md-nav__link">
        交替打印字符串
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/24/" class="md-nav__link">
        无重叠区域
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/25/" class="md-nav__link">
        种花问题（2021第一题）
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/26/" class="md-nav__link">
        合并区间
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/27/" class="md-nav__link">
        三数之和
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/28/" class="md-nav__link">
        对角线遍历
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/29/" class="md-nav__link">
        最长回文子串
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/30/" class="md-nav__link">
        长度最小的子数组
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/31/" class="md-nav__link">
        删除排序数组中的重复项
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/32/" class="md-nav__link">
        合并两个有序链表
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/33/" class="md-nav__link">
        使括号有效的最小添加
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/34/" class="md-nav__link">
        平衡括号字符串的最少插入次数
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/35/" class="md-nav__link">
        阶乘函数后K个零
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/36/" class="md-nav__link">
        搜索旋转排序数组
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/37/" class="md-nav__link">
        两两交换链表中的节点
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/38/" class="md-nav__link">
        把数字翻译成字符串
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/39/" class="md-nav__link">
        检查平衡性
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/40/" class="md-nav__link">
        可获得的最大点数
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/41/" class="md-nav__link">
        字符串的排列
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/42/" class="md-nav__link">
        至少有k个重复字符的最长字串
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/43/" class="md-nav__link">
        丑数系列
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/44/" class="md-nav__link">
        最大数
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/45/" class="md-nav__link">
        采购方案
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/46/" class="md-nav__link">
        和为s的连续正数序列
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/47/" class="md-nav__link">
        滑动窗口的中位数
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/48/" class="md-nav__link">
        对称二叉树
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/49/" class="md-nav__link">
        最长递增子序列
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sf/50/" class="md-nav__link">
        分割等和子集
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Python
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Python" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Python
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/" class="md-nav__link">
        介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/plotly/" class="md-nav__link">
        Plotly
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/jupyter/" class="md-nav__link">
        Jupyter
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/thread/" class="md-nav__link">
        多线程
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/asyncio/" class="md-nav__link">
        asyncio模块异步编程
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/skill/" class="md-nav__link">
        技巧
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/WTF/" class="md-nav__link">
        WTFpython学习
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/pyqt/" class="md-nav__link">
        pyqt学习
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/logging/" class="md-nav__link">
        logging模块学习
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/pyplot/" class="md-nav__link">
        Matplotlib.pyplot学习
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          爬虫
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="爬虫" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          爬虫
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../spider/base/" class="md-nav__link">
        基础
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../spider/thread_spider/" class="md-nav__link">
        多线程爬虫
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Numpy & Pandas
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Numpy & Pandas" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Numpy & Pandas
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pandas/learn_one/" class="md-nav__link">
        学习1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pandas/learn_two/" class="md-nav__link">
        学习2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pandas/task1/" class="md-nav__link">
        pandas实践1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pandas/task2/" class="md-nav__link">
        pandas实践2
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Sklearn
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Sklearn" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Sklearn
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sklearn/%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86/" class="md-nav__link">
        数据预处理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sklearn/%E7%AE%80%E5%8D%95%E7%9A%84%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/" class="md-nav__link">
        简单的线性回归
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sklearn/%E5%A4%8D%E6%9D%82%E7%9A%84%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/" class="md-nav__link">
        复杂的线性回归
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sklearn/Logistic%20Regression/" class="md-nav__link">
        Logistic Regression
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sklearn/KNN/" class="md-nav__link">
        KNN
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sklearn/SVM/" class="md-nav__link">
        SVM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sklearn/Decision%20Tree/" class="md-nav__link">
        Decision Tree
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sklearn/random%20forest/" class="md-nav__link">
        Random Forest
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sklearn/%E4%BA%A4%E5%8F%89%E9%AA%8C%E8%AF%81/" class="md-nav__link">
        交叉验证
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sklearn/kmeans/" class="md-nav__link">
        K-means聚类算法
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          AI学习
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="AI学习" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          AI学习
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pytorch/start/" class="md-nav__link">
        pytorch基础
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pytorch/regression/" class="md-nav__link">
        pytorch线性回归
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../opencv-learn/" class="md-nav__link">
        opencv学习
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          神经网络逻辑回归
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        神经网络逻辑回归
      </a>
      
        


<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1 数据预处理
  </a>
  
    <nav class="md-nav" aria-label="1 数据预处理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11" class="md-nav__link">
    1.1 数据加载和查看
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12" class="md-nav__link">
    1.2 数据变换
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2 神经网络的搭建
  </a>
  
    <nav class="md-nav" aria-label="2 神经网络的搭建">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21_sigmoid" class="md-nav__link">
    2.1 Sigmoid函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22" class="md-nav__link">
    2.2 初始化参数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23" class="md-nav__link">
    2.3 成本函数和梯度
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24" class="md-nav__link">
    2.4 优化函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25" class="md-nav__link">
    2.5 实现预测函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#26" class="md-nav__link">
    2.6 构建神经网络模型
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3 模型结果分析
  </a>
  
    <nav class="md-nav" aria-label="3 模型结果分析">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31" class="md-nav__link">
    3.1 学习率的选择
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../regular%20expression/" class="md-nav__link">
        正规方程推导
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          kotlin学习
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="kotlin学习" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          kotlin学习
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../kotlin_learn/basic/" class="md-nav__link">
        基础学习
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10">
          其他
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="其他" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          其他
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../others/vim/" class="md-nav__link">
        vim
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../others/git/" class="md-nav__link">
        git
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../others/regex/" class="md-nav__link">
        regex
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../others/sql/" class="md-nav__link">
        sql
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../others/one_test/" class="md-nav__link">
        博客后台案例
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../others/linux/" class="md-nav__link">
        linux学习
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../others/jupyter_pdf/" class="md-nav__link">
        浅谈jupyter导出为pdf
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../others/others/" class="md-nav__link">
        常用学习网站书籍
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1 数据预处理
  </a>
  
    <nav class="md-nav" aria-label="1 数据预处理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11" class="md-nav__link">
    1.1 数据加载和查看
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12" class="md-nav__link">
    1.2 数据变换
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2 神经网络的搭建
  </a>
  
    <nav class="md-nav" aria-label="2 神经网络的搭建">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21_sigmoid" class="md-nav__link">
    2.1 Sigmoid函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22" class="md-nav__link">
    2.2 初始化参数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23" class="md-nav__link">
    2.3 成本函数和梯度
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24" class="md-nav__link">
    2.4 优化函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25" class="md-nav__link">
    2.5 实现预测函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#26" class="md-nav__link">
    2.6 构建神经网络模型
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3 模型结果分析
  </a>
  
    <nav class="md-nav" aria-label="3 模型结果分析">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31" class="md-nav__link">
    3.1 学习率的选择
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="1-logistic">练习1-具有神经网络思维的Logistic回归<a class="headerlink" href="#1-logistic" title="Permanent link">&para;</a></h1>
<hr />
<h2 id="1">1 数据预处理<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 数据加载和查看<a class="headerlink" href="#11" title="Permanent link">&para;</a></h3>
<p>在开始之前，我们有需要引入的库：</p>
<ul>
<li>numpy ：是用Python进行科学计算的基本软件包。</li>
<li>h5py：是与H5文件中存储的数据集进行交互的常用软件包。</li>
<li>matplotlib：是一个著名的库，用于在Python中绘制图表。</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">h5py</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">conda</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">h5py</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">36</span><span class="p">:</span> <span class="ne">FutureWarning</span><span class="p">:</span> <span class="n">Conversion</span> <span class="n">of</span> <span class="n">the</span> <span class="n">second</span> <span class="n">argument</span> <span class="n">of</span> <span class="n">issubdtype</span> <span class="kn">from</span> <span class="err">`</span><span class="nb">float</span><span class="err">`</span> <span class="n">to</span> <span class="err">`</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="err">`</span> <span class="ow">is</span> <span class="n">deprecated</span><span class="o">.</span> <span class="n">In</span> <span class="n">future</span><span class="p">,</span> <span class="n">it</span> <span class="n">will</span> <span class="n">be</span> <span class="n">treated</span> <span class="k">as</span> <span class="err">`</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">type</span><span class="err">`</span><span class="o">.</span>
  <span class="kn">from</span> <span class="nn">._conv</span> <span class="kn">import</span> <span class="n">register_converters</span> <span class="k">as</span> <span class="n">_register_converters</span>
</code></pre></div>

<p>接下来，需要运行load_dataset函数来读取数据文件中所存储的数据，并返回：</p>
<ul>
<li>train_set_x_orig ：保存的是训练集里面的图像数据(209张64x64的图像)；</li>
<li>train_set_y_orig ：保存的是训练集的图像对应的分类值，其中0表示不是猫，1表示是猫。</li>
<li>test_set_x_orig ：保存的是测试集里面的图像数据(50张64x64的图像)；</li>
<li>test_set_y_orig ： 保存的是测试集的图像对应的分类值。</li>
<li>classes ： 保存的是以字节类型保存的两个字符串数据，数据为：[b’non-cat’ b’cat’]。</li>
</ul>
<p>现在我们就要把这些数据加载到主程序里面：</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">load_dataset</span><span class="p">():</span>
    <span class="n">train_dataset</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;train_catvnoncat.h5&#39;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">train_set_x_orig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">[</span><span class="s2">&quot;train_set_x&quot;</span><span class="p">][:])</span> <span class="c1"># your train set features</span>
    <span class="n">train_set_y_orig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">[</span><span class="s2">&quot;train_set_y&quot;</span><span class="p">][:])</span> <span class="c1"># your train set labels</span>

    <span class="n">test_dataset</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;test_catvnoncat.h5&#39;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">test_set_x_orig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">[</span><span class="s2">&quot;test_set_x&quot;</span><span class="p">][:])</span> <span class="c1"># your test set features</span>
    <span class="n">test_set_y_orig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">[</span><span class="s2">&quot;test_set_y&quot;</span><span class="p">][:])</span> <span class="c1"># your test set labels</span>

    <span class="n">classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">[</span><span class="s2">&quot;list_classes&quot;</span><span class="p">][:])</span> <span class="c1"># the list of classes</span>

    <span class="n">train_set_y_orig</span> <span class="o">=</span> <span class="n">train_set_y_orig</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">train_set_y_orig</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">test_set_y_orig</span> <span class="o">=</span> <span class="n">test_set_y_orig</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">test_set_y_orig</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

    <span class="k">return</span> <span class="n">train_set_x_orig</span><span class="p">,</span> <span class="n">train_set_y_orig</span><span class="p">,</span> <span class="n">test_set_x_orig</span><span class="p">,</span> <span class="n">test_set_y_orig</span><span class="p">,</span> <span class="n">classes</span>
<span class="n">train_set_x_orig</span> <span class="p">,</span> <span class="n">train_set_y</span> <span class="p">,</span> <span class="n">test_set_x_orig</span> <span class="p">,</span> <span class="n">test_set_y</span> <span class="p">,</span> <span class="n">classes</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">()</span>
</code></pre></div>
<p>我们可以看一下加载的文件里面的图片都是些什么样子的以及存储的分类值。可以看到，当我们改变index值时，会出现不同索引值的图片，且train_set_y的值代表了该图像是否为一只猫。</p>
<div class="highlight"><pre><span></span><code><span class="n">index</span> <span class="o">=</span> <span class="mi">56</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">train_set_x_orig</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;train_set_y=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">train_set_y</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">index</span><span class="p">]))</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;y=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">train_set_y</span><span class="p">[:,</span><span class="n">index</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;, it&#39;s a &quot;</span> <span class="o">+</span> <span class="n">classes</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">train_set_y</span><span class="p">[:,</span><span class="n">index</span><span class="p">])]</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39; picture&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>train_set_y=1
y=[1], it&#39;s a cat&#39; picture
</code></pre></div>

<p><img alt="png" src="../output_6_1.png" /></p>
<div class="highlight"><pre><span></span><code><span class="n">index</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">train_set_x_orig</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;train_set_y=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">train_set_y</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">index</span><span class="p">]))</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;y=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">train_set_y</span><span class="p">[:,</span><span class="n">index</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;, it&#39;s a &quot;</span> <span class="o">+</span> <span class="n">classes</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">train_set_y</span><span class="p">[:,</span><span class="n">index</span><span class="p">])]</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39; picture&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>train_set_y=0
y=[0], it&#39;s a non-cat&#39; picture
</code></pre></div>

<p><img alt="png" src="../output_7_1.png" /></p>
<h3 id="12">1.2 数据变换<a class="headerlink" href="#12" title="Permanent link">&para;</a></h3>
<p>接下来看一看我们加载的数据的具体信息，首先介绍三个变量的含义：
- m_train ：训练集里图片的数量。
- m_test ：测试集里图片的数量。
- num_px ： 训练、测试集里面的图片的宽度和高度（均为64x64）。</p>
<p>train_set_x_orig 是一个维度为(m_​​train，num_px，num_px，3）的数组。</p>
<div class="highlight"><pre><span></span><code><span class="n">m_train</span> <span class="o">=</span> <span class="n">train_set_y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1">#训练集里图片的数量。</span>
<span class="n">m_test</span> <span class="o">=</span> <span class="n">test_set_y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1">#测试集里图片的数量。</span>
<span class="n">num_px</span> <span class="o">=</span> <span class="n">train_set_x_orig</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1">#训练、测试集里面的图片的宽度和高度（均为64x64）。</span>

<span class="c1">#现在看一看我们加载的东西的具体情况</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;训练集的数量: m_train = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">m_train</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;测试集的数量 : m_test = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">m_test</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;每张图片的宽/高 : num_px = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">num_px</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;每张图片的大小 : (&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">num_px</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">num_px</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;, 3)&quot;</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;训练集_图片的维数 : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">train_set_x_orig</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;训练集_标签的维数 : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">train_set_y</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;测试集_图片的维数: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">test_set_x_orig</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;测试集_标签的维数: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">test_set_y</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="err">训练集的数量</span><span class="o">:</span> <span class="n">m_train</span> <span class="o">=</span> <span class="mi">209</span>
<span class="err">测试集的数量</span> <span class="o">:</span> <span class="n">m_test</span> <span class="o">=</span> <span class="mi">50</span>
<span class="err">每张图片的宽</span><span class="o">/</span><span class="err">高</span> <span class="o">:</span> <span class="n">num_px</span> <span class="o">=</span> <span class="mi">64</span>
<span class="err">每张图片的大小</span> <span class="o">:</span> <span class="o">(</span><span class="mi">64</span><span class="o">,</span> <span class="mi">64</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span>
<span class="err">训练集</span><span class="n">_图片的维数</span> <span class="o">:</span> <span class="o">(</span><span class="mi">209</span><span class="o">,</span> <span class="mi">64</span><span class="o">,</span> <span class="mi">64</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span>
<span class="err">训练集</span><span class="n">_标签的维数</span> <span class="o">:</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">209</span><span class="o">)</span>
<span class="err">测试集</span><span class="n">_图片的维数</span><span class="o">:</span> <span class="o">(</span><span class="mi">50</span><span class="o">,</span> <span class="mi">64</span><span class="o">,</span> <span class="mi">64</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span>
<span class="err">测试集</span><span class="n">_标签的维数</span><span class="o">:</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">50</span><span class="o">)</span>
</code></pre></div>

<p>为了方便，我们要把维度为<code>(64,64,3)</code>的numpy数组重新构造为<code>(64*64*3,1)</code>的数组，要乘以3的原因是每张图片是由<code>64x64</code>像素构成的，而每个像素点由（R，G，B）三原色构成的，所以要乘以3。</p>
<p>在此之后，我们的训练和测试数据集是一个numpy数组，<strong>每列代表一个平坦的图像</strong>，应该有m_train和m_test列。</p>
<p>当你想将形状（a，b，c，d）的矩阵X平铺成形状（b * c * d，a）的矩阵X_flatten时，可以使用以下代码：</p>
<div class="highlight"><pre><span></span><code><span class="c1">#X_flatten = X.reshape(X.shape [0]，-1).T ＃X.T是X的转置</span>
<span class="c1">#将训练集的维度降低并转置。</span>
<span class="n">train_set_x_flatten</span>  <span class="o">=</span> <span class="n">train_set_x_orig</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">train_set_x_orig</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="c1">#将测试集的维度降低并转置。</span>
<span class="n">test_set_x_flatten</span> <span class="o">=</span> <span class="n">test_set_x_orig</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">test_set_x_orig</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</code></pre></div>
<p>这一段意思是指把数组变为209行的矩阵（因为训练集里有209张图片）我们可以用-1使得程序算出来是12288列，我再最后用一个T表示转置，这就变成了12288行，209列。</p>
<p>测试集的操作也一样。</p>
<p>然后我们看看降维之后的情况是怎么样的：</p>
<div class="highlight"><pre><span></span><code><span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;训练集降维最后的维度： &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">train_set_x_flatten</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;训练集_标签的维数 : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">train_set_y</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;测试集降维之后的维度: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">test_set_x_flatten</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;测试集_标签的维数 : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">test_set_y</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>训练集降维最后的维度： (12288, 209)
训练集_标签的维数 : (1, 209)
测试集降维之后的维度: (12288, 50)
测试集_标签的维数 : (1, 50)
</code></pre></div>

<p>为了表示彩色图像，必须为每个像素指定红色，绿色和蓝色通道（RGB），因此像素值实际上是从0到255范围内的三个数字的向量。</p>
<p>机器学习中一个常见的预处理步骤是**对数据集进行居中和标准化**，这意味着可以减去每个示例中整个numpy数组的平均值，然后将每个示例除以整个numpy数组的标准偏差。</p>
<p>但对于图片数据集，它更简单，更方便，几乎可以将**数据集的每一行除以255**（像素通道的最大值），因为在RGB中不存在比255大的数据，所以我们可以放心的除以255，让标准化的数据位于[0,1]之间。</p>
<div class="highlight"><pre><span></span><code><span class="n">train_set_x</span> <span class="o">=</span> <span class="n">train_set_x_flatten</span> <span class="o">/</span> <span class="mi">255</span>
<span class="n">test_set_x</span> <span class="o">=</span> <span class="n">test_set_x_flatten</span> <span class="o">/</span> <span class="mi">255</span>
</code></pre></div>
<h2 id="2">2 神经网络的搭建<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<p>数据处理完毕后，我们需要开始搭建神经网络。
以下是数学表达式：</p>
<p>对于 <span class="arithmatex"><span class="MathJax_Preview">x(i)</span><script type="math/tex">x(i)</script></span>:
<span class="arithmatex"><span class="MathJax_Preview"><span class="arithmatex"><span class="MathJax_Preview">{{z}^{(i)}}={{w}^{T}}{{x}^{(i)}}+b</span><script type="math/tex">{{z}^{(i)}}={{w}^{T}}{{x}^{(i)}}+b</script></span></span><script type="math/tex"><span class="arithmatex"><span class="MathJax_Preview">{{z}^{(i)}}={{w}^{T}}{{x}^{(i)}}+b</span><script type="math/tex">{{z}^{(i)}}={{w}^{T}}{{x}^{(i)}}+b</script></span></script></span>
<span class="arithmatex"><span class="MathJax_Preview"><span class="arithmatex"><span class="MathJax_Preview">\hat{y}^{(i)}=a(i)=sigmoid(z(i))</span><script type="math/tex">\hat{y}^{(i)}=a(i)=sigmoid(z(i))</script></span></span><script type="math/tex"><span class="arithmatex"><span class="MathJax_Preview">\hat{y}^{(i)}=a(i)=sigmoid(z(i))</span><script type="math/tex">\hat{y}^{(i)}=a(i)=sigmoid(z(i))</script></span></script></span>
<span class="arithmatex"><span class="MathJax_Preview"><span class="arithmatex"><span class="MathJax_Preview">L\left( \hat{y},y \right)=-y\log(\hat{y})-(1-y)\log (1-\hat{y})</span><script type="math/tex">L\left( \hat{y},y \right)=-y\log(\hat{y})-(1-y)\log (1-\hat{y})</script></span></span><script type="math/tex"><span class="arithmatex"><span class="MathJax_Preview">L\left( \hat{y},y \right)=-y\log(\hat{y})-(1-y)\log (1-\hat{y})</span><script type="math/tex">L\left( \hat{y},y \right)=-y\log(\hat{y})-(1-y)\log (1-\hat{y})</script></span></script></span></p>
<p>然后通过对所有训练样例求和来计算成本:
$$
J\left( w,b \right)=\frac{1}{m}\sum\limits_{i=1}^{m}{L\left( {{{\hat{y}}}<sup>{(i)}},{{y}</sup>{(i)}} \right)}=\frac{1}{m}\sum\limits_{i=1}^{m}{\left( -{{y}^{(i)}}\log {{{\hat{y}}}<sup>{(i)}}-(1-{{y}</sup>{(i)}})\log (1-{{{\hat{y}}}^{(i)}}) \right)}
$$
建立神经网络的主要步骤是： 
1. 定义模型结构（例如输入特征的数量） 
2. 初始化模型的参数 
3. 循环：</p>
<div class="codehilite"><pre><span></span><code><span class="mf">1.</span> <span class="n">计算当前损失</span><span class="err">（</span><span class="n">正向传播</span><span class="err">）</span>
<span class="mf">2.</span> <span class="n">计算当前梯度</span><span class="err">（</span><span class="n">反向传播</span><span class="err">）</span>
<span class="mf">3.</span> <span class="n">更新参数</span><span class="err">（</span><span class="n">梯度下降</span><span class="err">）</span>
</code></pre></div>

<h3 id="21_sigmoid">2.1 Sigmoid函数<span id='1'></span><a class="headerlink" href="#21_sigmoid" title="Permanent link">&para;</a></h3>
<p>现在构建sigmoid()，需要使用 <span class="arithmatex"><span class="MathJax_Preview">sigmoid(w ^ T x + b)</span><script type="math/tex">sigmoid(w ^ T x + b)</script></span> 计算来做出预测。</p>
<p>其中，sigmoid代表一个常用的逻辑函数为S形函数（Sigmoid function），公式为： 
\[g\left( z \right)=\frac{1}{1+{{e}^{-z}}}\] </p>
<p>接下来，你需要**编写代码实现Sigmoid函数**，编写后试着测试一些值，如果<code>x</code>的正值较大，则函数值应接近1；如果<code>x</code>的负值较大，则函数值应接近0。而对于<code>x</code>等于0时，则函数值为0.5。</p>
<div class="highlight"><pre><span></span><code><span class="c1">###在这里填入代码###</span>
<span class="k">def</span> <span class="nf">sigmoid</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    参数：</span>
<span class="sd">        z  - 任何大小的标量或numpy数组。</span>
<span class="sd">    返回：</span>
<span class="sd">        s  -  sigmoid（z）</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">s</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">#测试sigmoid()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;====================测试sigmoid====================&quot;</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;sigmoid(0) = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sigmoid</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;sigmoid(9.2) = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sigmoid</span><span class="p">(</span><span class="mf">9.2</span><span class="p">)))</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>====================测试sigmoid====================
sigmoid(0) = 0.5
sigmoid(9.2) = 0.9998989708060922
</code></pre></div>

<h3 id="22">2.2 初始化参数<a class="headerlink" href="#22" title="Permanent link">&para;</a></h3>
<p>接下来，在搭建神经网络之前，我们需要初始化参数w和b，将w初始化为指定维度的零向量，b初始化为0。</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">initialize_with_zeros</span><span class="p">(</span><span class="n">dim</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        此函数为w创建一个维度为（dim，1）的0向量，并将b初始化为0。</span>
<span class="sd">        参数：</span>
<span class="sd">            dim  - 我们想要的w矢量的大小（或者这种情况下的参数数量）</span>
<span class="sd">        返回：</span>
<span class="sd">            w  - 维度为（dim，1）的初始化向量。</span>
<span class="sd">            b  - 初始化的标量（对应于偏差）</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1">#使用断言来确保我要的数据是正确的</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="c1">#w的维度是(dim,1)</span>
    <span class="k">assert</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="nb">int</span><span class="p">))</span> <span class="c1">#b的类型是float或者是int</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">w</span> <span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</code></pre></div>
<h3 id="23">2.3 成本函数和梯度<span id='2'></span><a class="headerlink" href="#23" title="Permanent link">&para;</a></h3>
<p>对参数进行初始化后，可以接着实现前向和后向传播的成本函数及其梯度，用于后续的参数学习，最小化成本。</p>
<p>接下来，你需要**实现propagate函数，该函数用于实现前向传播的成本计算和后向传播的梯度计算**。</p>
<p>参数<span class="arithmatex"><span class="MathJax_Preview">w</span><script type="math/tex">w</script></span>和<span class="arithmatex"><span class="MathJax_Preview">b</span><script type="math/tex">b</script></span>梯度的求解：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\frac{\partial J}{\partial w}=\frac{1}{m}\sum\limits_{i=1}^{m}\frac{\partial J}{\partial a^{(i)}}\frac{\partial a^{(i)}}{\partial  z^{(i)}}\frac{\partial z^{(i)}}{\partial w}
</div>
<script type="math/tex; mode=display">
\frac{\partial J}{\partial w}=\frac{1}{m}\sum\limits_{i=1}^{m}\frac{\partial J}{\partial a^{(i)}}\frac{\partial a^{(i)}}{\partial  z^{(i)}}\frac{\partial z^{(i)}}{\partial w}
</script>
</div>
<div class="arithmatex">
<div class="MathJax_Preview">
\frac{\partial J}{\partial a^{(i)}}= -\frac{y}{a^{(i)}}+\frac{1-y}{1-a^{(i)}}
</div>
<script type="math/tex; mode=display">
\frac{\partial J}{\partial a^{(i)}}= -\frac{y}{a^{(i)}}+\frac{1-y}{1-a^{(i)}}
</script>
</div>
<div class="arithmatex">
<div class="MathJax_Preview">
\frac{\partial g(z)}{\partial z}=-\frac{1}{(1+e^{-z})^2}(-e^{-z})=\frac{e^{-z}}{1+e^{-z}}=\frac{1}{1+{{e}^{-z}}}\times(1-\frac{1}{1+{{e}^{-z}}})=g(z)(1-g(z))
</div>
<script type="math/tex; mode=display">
\frac{\partial g(z)}{\partial z}=-\frac{1}{(1+e^{-z})^2}(-e^{-z})=\frac{e^{-z}}{1+e^{-z}}=\frac{1}{1+{{e}^{-z}}}\times(1-\frac{1}{1+{{e}^{-z}}})=g(z)(1-g(z))
</script>
</div>
<p>所以
$$
\frac{\partial a^{(i)}}{\partial  z<sup>{(i)}}=a</sup>{(i)}(1-a^{(i)})
$$</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\frac{\partial z^{(i)}}{\partial w}=x^{(i)}
</div>
<script type="math/tex; mode=display">
\frac{\partial z^{(i)}}{\partial w}=x^{(i)}
</script>
</div>
<p>可得，
$$
\frac{\partial J}{\partial w}=\frac{1}{m}\sum\limits_{i=1}<sup>{m}(a</sup>{(i)}-y)x^{(i)}
$$
求和可以使用numpy的dot函数通过内积计算来实现。</p>
<p>同样地，推导可得，
$$
\frac{\partial J}{\partial b}=\frac{1}{m}\sum\limits_{i=1}<sup>{m}(a</sup>{(i)}-y)
$$
<strong>要点</strong>：</p>
<ul>
<li>参数列表和返回值需要与函数说明中相同，其中返回值dw,db需要以字典的形式进行返回；</li>
<li>在函数中需要实现正向传播计算成本和反向传播计算梯度。</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1">###在这里填入代码###</span>
<span class="k">def</span> <span class="nf">propagate</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    实现前向和后向传播的成本函数及其梯度。</span>
<span class="sd">    参数：</span>
<span class="sd">        w  - 权重，大小不等的数组（num_px * num_px * 3，1）</span>
<span class="sd">        b  - 偏差，一个标量</span>
<span class="sd">        X  - 矩阵类型为（num_px * num_px * 3，训练数量）</span>
<span class="sd">        Y  - 真正的“标签”矢量（如果非猫则为0，如果是猫则为1），矩阵维度为(1,训练数据数量)</span>
<span class="sd">    返回：</span>
<span class="sd">        cost- 逻辑回归的负对数似然成本</span>
<span class="sd">        dw  - 相对于w的损失梯度，因此与w相同的形状</span>
<span class="sd">        db  - 相对于b的损失梯度，因此与b的形状相同</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1">#正向传播，计算激活值。</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">X</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>
    <span class="c1">#计算成本</span>
    <span class="n">cost</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">m</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Y</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Y</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">A</span><span class="p">))</span>
    <span class="c1">#反向传播</span>
    <span class="n">dw</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">m</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">,(</span><span class="n">A</span><span class="o">-</span><span class="n">Y</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="n">db</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">m</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="n">Y</span><span class="p">)</span>
    <span class="c1">#使用断言确保我的数据是正确的</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">dw</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">w</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">float</span><span class="p">)</span>
    <span class="n">cost</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">cost</span><span class="p">)</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">cost</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">())</span>
    <span class="c1">#创建一个字典，把dw和db保存起来。</span>
    <span class="n">grads</span> <span class="o">=</span><span class="p">{</span><span class="s2">&quot;dw&quot;</span><span class="p">:</span><span class="n">dw</span><span class="p">,</span><span class="s2">&quot;db&quot;</span><span class="p">:</span><span class="n">db</span><span class="p">}</span>



    <span class="k">return</span> <span class="p">(</span><span class="n">grads</span> <span class="p">,</span> <span class="n">cost</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">#测试一下propagate</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;====================测试propagate====================&quot;</span><span class="p">)</span>
<span class="c1">#初始化一些参数</span>
<span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]]),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="n">grads</span><span class="p">,</span> <span class="n">cost</span> <span class="o">=</span> <span class="n">propagate</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;dw = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">grads</span><span class="p">[</span><span class="s2">&quot;dw&quot;</span><span class="p">]))</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;db = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">grads</span><span class="p">[</span><span class="s2">&quot;db&quot;</span><span class="p">]))</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;cost = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">cost</span><span class="p">))</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>====================测试propagate====================
6.000064773192205
dw = [[0.99993216]
 [1.99980262]]
db = 0.49993523062470574
cost = 6.000064773192205
</code></pre></div>

<h3 id="24">2.4 优化函数<span id='3'></span><a class="headerlink" href="#24" title="Permanent link">&para;</a></h3>
<p>接下来，你需要**定义optimize函数通过使用propagate函数计算成本和梯度来最小化成本，并学习最优参数w和b**。对于参数 <span class="arithmatex"><span class="MathJax_Preview">\theta</span><script type="math/tex">\theta</script></span> ，更新规则是 $ \theta = \theta - \alpha \text{ } d\theta$（梯度下降法），其中 <span class="arithmatex"><span class="MathJax_Preview">\alpha</span><script type="math/tex">\alpha</script></span> 是学习率。</p>
<p><strong>要点</strong>：
- 参数列表和返回列表如函数说明中所示，注意返回值的数据类型；
- 我们需要写下两个步骤并遍历它们：
    1. 计算当前参数的成本和梯度，使用propagate（）。
    2. 使用w和b的梯度下降法则更新参数。</p>
<div class="highlight"><pre><span></span><code><span class="c1">###在这里填入代码###</span>
<span class="k">def</span> <span class="nf">optimize</span><span class="p">(</span><span class="n">w</span> <span class="p">,</span> <span class="n">b</span> <span class="p">,</span> <span class="n">X</span> <span class="p">,</span> <span class="n">Y</span> <span class="p">,</span> <span class="n">num_iterations</span> <span class="p">,</span> <span class="n">learning_rate</span> <span class="p">,</span> <span class="n">print_cost</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    此函数通过运行梯度下降算法来优化w和b</span>
<span class="sd">    参数：</span>
<span class="sd">        w  - 权重，大小不等的数组（num_px * num_px * 3，1）</span>
<span class="sd">        b  - 偏差，一个标量</span>
<span class="sd">        X  - 维度为（num_px * num_px * 3，训练数据的数量）的数组。</span>
<span class="sd">        Y  - 真正的“标签”矢量（如果非猫则为0，如果是猫则为1），矩阵维度为(1,训练数据的数量)</span>
<span class="sd">        num_iterations  - 优化循环的迭代次数</span>
<span class="sd">        learning_rate  - 梯度下降更新规则的学习率</span>
<span class="sd">        print_cost  - 每100步打印一次损失值</span>
<span class="sd">    返回：</span>
<span class="sd">        params  - 包含权重w和偏差b的`字典`</span>
<span class="sd">        grads  - 包含权重和偏差相对于成本函数的梯度的`字典`</span>
<span class="sd">        costs - 优化期间计算的所有成本`列表`，将用于绘制学习曲线。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">costs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_iterations</span><span class="p">):</span>

        <span class="n">grads</span><span class="p">,</span> <span class="n">cost</span> <span class="o">=</span> <span class="n">propagate</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>

        <span class="n">dw</span> <span class="o">=</span> <span class="n">grads</span><span class="p">[</span><span class="s2">&quot;dw&quot;</span><span class="p">]</span>
        <span class="n">db</span> <span class="o">=</span> <span class="n">grads</span><span class="p">[</span><span class="s2">&quot;db&quot;</span><span class="p">]</span>

        <span class="n">w</span> <span class="o">=</span> <span class="n">w</span> <span class="o">-</span> <span class="n">learning_rate</span><span class="o">*</span><span class="n">dw</span>                                      <span class="c1">#更新参数w</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">b</span> <span class="o">-</span> <span class="n">learning_rate</span><span class="o">*</span><span class="n">db</span>                                      <span class="c1">#更新参数b</span>

        <span class="c1">#记录成本</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">costs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cost</span><span class="p">)</span>
        <span class="c1">#打印成本数据</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">print_cost</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;迭代的次数: </span><span class="si">%i</span><span class="s2"> ， 误差值： </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">cost</span><span class="p">))</span>

    <span class="n">params</span>  <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;w&quot;</span> <span class="p">:</span> <span class="n">w</span><span class="p">,</span>
                <span class="s2">&quot;b&quot;</span> <span class="p">:</span> <span class="n">b</span> <span class="p">}</span>
    <span class="n">grads</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;dw&quot;</span><span class="p">:</span> <span class="n">dw</span><span class="p">,</span>
            <span class="s2">&quot;db&quot;</span><span class="p">:</span> <span class="n">db</span> <span class="p">}</span> 
    <span class="k">return</span> <span class="p">(</span><span class="n">params</span> <span class="p">,</span> <span class="n">grads</span> <span class="p">,</span> <span class="n">costs</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">#测试optimize</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;====================测试optimize====================&quot;</span><span class="p">)</span>
<span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]]),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="n">params</span> <span class="p">,</span> <span class="n">grads</span> <span class="p">,</span> <span class="n">costs</span> <span class="o">=</span> <span class="n">optimize</span><span class="p">(</span><span class="n">w</span> <span class="p">,</span> <span class="n">b</span> <span class="p">,</span> <span class="n">X</span> <span class="p">,</span> <span class="n">Y</span> <span class="p">,</span> <span class="n">num_iterations</span><span class="o">=</span><span class="mi">100</span> <span class="p">,</span> <span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.009</span> <span class="p">,</span> <span class="n">print_cost</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;w = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]))</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;b = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">]))</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;dw = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">grads</span><span class="p">[</span><span class="s2">&quot;dw&quot;</span><span class="p">]))</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;db = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">grads</span><span class="p">[</span><span class="s2">&quot;db&quot;</span><span class="p">]))</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>====================测试optimize====================
w = [[0.1124579 ]
 [0.23106775]]
b = 1.5593049248448891
dw = [[0.90158428]
 [1.76250842]]
db = 0.4304620716786828
</code></pre></div>

<h3 id="25">2.5 实现预测函数<span id='4'></span><a class="headerlink" href="#25" title="Permanent link">&para;</a></h3>
<p>通过优化函数可以输出已学习的w和b的值，我们可以使用w和b来预测数据集X的标签。</p>
<p>接下来，你需要**实现预测函数predict（）**。</p>
<p>计算预测有两个步骤：
1. 计算<span class="arithmatex"><span class="MathJax_Preview">\bar{Y}=A=\sigma(w^TX+b)</span><script type="math/tex">\bar{Y}=A=\sigma(w^TX+b)</script></span>
2. 将a的值变为0（如果激活值&lt;= 0.5）或者为1（如果激活值&gt; 0.5）</p>
<p>然后将预测值存储在向量Y_prediction中。</p>
<div class="highlight"><pre><span></span><code><span class="c1">###在这里填入代码###</span>
<span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="n">w</span> <span class="p">,</span> <span class="n">b</span> <span class="p">,</span> <span class="n">X</span> <span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    使用学习逻辑回归参数logistic （w，b）预测标签是0还是1，</span>
<span class="sd">    参数：</span>
<span class="sd">        w  - 权重，大小不等的数组（num_px * num_px * 3，1）</span>
<span class="sd">        b  - 偏差，一个标量</span>
<span class="sd">        X  - 维度为（num_px * num_px * 3，训练数据的数量）的数据</span>
<span class="sd">    返回：</span>
<span class="sd">        Y_prediction  - 包含X中所有图片的所有预测【0 | 1】的一个numpy数组（向量）</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#计算预测猫在图片中出现的概率</span>

    <span class="n">m</span>  <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1">#图片的数量</span>
    <span class="n">Y_prediction</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="n">m</span><span class="p">))</span> 

    <span class="c1">#计预测猫在图片中出现的概率</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">X</span><span class="p">)</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="c1">#将概率a [0，i]转换为实际预测p [0，i]</span>
        <span class="n">Y_prediction</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span> <span class="k">if</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.5</span> <span class="k">else</span> <span class="s2">&quot;0&quot;</span>

    <span class="c1">#使用断言</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">Y_prediction</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">m</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Y_prediction</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">#测试predict</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;====================测试predict====================&quot;</span><span class="p">)</span>
<span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]]),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;predictions = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">predict</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">X</span><span class="p">)))</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>====================测试predict====================
predictions = [[1. 1.]]
</code></pre></div>

<h3 id="26">2.6 构建神经网络模型<span id='4'></span><a class="headerlink" href="#26" title="Permanent link">&para;</a></h3>
<p>回顾搭建神经网络模型的步骤： 
1. 定义模型结构（例如输入特征的数量） 
2. 初始化模型的参数 
3. 循环：</p>
<div class="codehilite"><pre><span></span><code><span class="mf">1.</span> <span class="n">计算当前损失</span><span class="err">（</span><span class="n">正向传播</span><span class="err">）</span>
<span class="mf">2.</span> <span class="n">计算当前梯度</span><span class="err">（</span><span class="n">反向传播</span><span class="err">）</span>
<span class="mf">3.</span> <span class="n">更新参数</span><span class="err">（</span><span class="n">梯度下降</span><span class="err">）</span>
</code></pre></div>

<p>我们目前已经实现了参数的初始化、成本和梯度的计算、参数更新函数以及预测函数。接下来，你需要**搭建完整的神经网络模型，定义model()函数**。</p>
<p><strong>要点</strong>：
- 参数列表和返回列表如函数说明所示；
- 需要分别计算训练集和测试集预测的准确率并输出。</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">X_train</span> <span class="p">,</span> <span class="n">Y_train</span> <span class="p">,</span> <span class="n">X_test</span> <span class="p">,</span> <span class="n">Y_test</span> <span class="p">,</span> <span class="n">num_iterations</span> <span class="o">=</span> <span class="mi">2000</span> <span class="p">,</span> <span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="p">,</span> <span class="n">print_cost</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    通过调用之前实现的函数来构建逻辑回归模型</span>

<span class="sd">    参数：</span>
<span class="sd">        X_train  - numpy的数组,维度为（num_px * num_px * 3，m_train）的训练集</span>
<span class="sd">        Y_train  - numpy的数组,维度为（1，m_train）（矢量）的训练标签集</span>
<span class="sd">        X_test   - numpy的数组,维度为（num_px * num_px * 3，m_test）的测试集</span>
<span class="sd">        Y_test   - numpy的数组,维度为（1，m_test）的（向量）的测试标签集</span>
<span class="sd">        num_iterations  - 表示用于优化参数的迭代次数的超参数</span>
<span class="sd">        learning_rate  - 表示optimize（）更新规则中使用的学习速率的超参数</span>
<span class="sd">        print_cost  - 设置为true以每100次迭代打印成本</span>

<span class="sd">    返回：</span>
<span class="sd">        d  - 包含有关模型信息的字典。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">w</span> <span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">initialize_with_zeros</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">parameters</span> <span class="p">,</span> <span class="n">grads</span> <span class="p">,</span> <span class="n">costs</span> <span class="o">=</span> <span class="n">optimize</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">X_train</span><span class="p">,</span><span class="n">Y_train</span><span class="p">,</span><span class="n">num_iterations</span><span class="p">,</span><span class="n">learning_rate</span><span class="p">,</span><span class="n">print_cost</span><span class="p">)</span>

    <span class="c1">#从字典“参数”中检索参数w和b</span>
    <span class="n">w</span> <span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">],</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">]</span>

    <span class="c1">#预测测试/训练集的例子</span>
    <span class="n">Y_prediction_test</span> <span class="o">=</span> <span class="n">predict</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">Y_prediction_train</span> <span class="o">=</span> <span class="n">predict</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">X_train</span><span class="p">)</span>

    <span class="c1">#打印训练后的准确性</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;训练集准确性：&quot;</span>  <span class="p">,</span> <span class="nb">format</span><span class="p">(</span><span class="mi">100</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Y_prediction_train</span> <span class="o">-</span> <span class="n">Y_train</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="p">,</span><span class="s2">&quot;%&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;测试集准确性：&quot;</span>  <span class="p">,</span> <span class="nb">format</span><span class="p">(</span><span class="mi">100</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Y_prediction_test</span> <span class="o">-</span> <span class="n">Y_test</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="p">,</span><span class="s2">&quot;%&quot;</span><span class="p">)</span>



    <span class="n">d</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;costs&quot;</span> <span class="p">:</span> <span class="n">costs</span><span class="p">,</span>
            <span class="s2">&quot;Y_prediction_test&quot;</span> <span class="p">:</span> <span class="n">Y_prediction_test</span><span class="p">,</span>
            <span class="s2">&quot;Y_prediciton_train&quot;</span> <span class="p">:</span> <span class="n">Y_prediction_train</span><span class="p">,</span>
            <span class="s2">&quot;w&quot;</span> <span class="p">:</span> <span class="n">w</span><span class="p">,</span>
            <span class="s2">&quot;b&quot;</span> <span class="p">:</span> <span class="n">b</span><span class="p">,</span>
            <span class="s2">&quot;learning_rate&quot;</span> <span class="p">:</span> <span class="n">learning_rate</span><span class="p">,</span>
            <span class="s2">&quot;num_iterations&quot;</span> <span class="p">:</span> <span class="n">num_iterations</span> <span class="p">}</span>
    <span class="k">return</span> <span class="n">d</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;====================测试model====================&quot;</span><span class="p">)</span>     
<span class="c1">#这里加载的是真实的数据，请参见上面的代码部分。</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">train_set_x</span><span class="p">,</span> <span class="n">train_set_y</span><span class="p">,</span> <span class="n">test_set_x</span><span class="p">,</span> <span class="n">test_set_y</span><span class="p">,</span> <span class="n">num_iterations</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">,</span> <span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.005</span><span class="p">,</span> <span class="n">print_cost</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>====================测试model====================
迭代的次数: 0 ， 误差值： 0.693147
迭代的次数: 100 ， 误差值： 0.584508
迭代的次数: 200 ， 误差值： 0.466949
迭代的次数: 300 ， 误差值： 0.376007
迭代的次数: 400 ， 误差值： 0.331463
迭代的次数: 500 ， 误差值： 0.303273
迭代的次数: 600 ， 误差值： 0.279880
迭代的次数: 700 ， 误差值： 0.260042
迭代的次数: 800 ， 误差值： 0.242941
迭代的次数: 900 ， 误差值： 0.228004
迭代的次数: 1000 ， 误差值： 0.214820
迭代的次数: 1100 ， 误差值： 0.203078
迭代的次数: 1200 ， 误差值： 0.192544
迭代的次数: 1300 ， 误差值： 0.183033
迭代的次数: 1400 ， 误差值： 0.174399
迭代的次数: 1500 ， 误差值： 0.166521
迭代的次数: 1600 ， 误差值： 0.159305
迭代的次数: 1700 ， 误差值： 0.152667
迭代的次数: 1800 ， 误差值： 0.146542
迭代的次数: 1900 ， 误差值： 0.140872
训练集准确性： 99.04306220095694 %
测试集准确性： 70.0 %
</code></pre></div>

<h2 id="3">3 模型结果分析<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<p>在上述的模型结果中，我们可以看到模型在训练集和测试集上的不同表现。当我们修改学习率和迭代次数时，准确率会有些许的变化。现在我们将模型训练过程中的成本优化过程可视化，直观的观察模型训练过程。</p>
<div class="highlight"><pre><span></span><code><span class="c1">#绘制图</span>
<span class="n">costs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;costs&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">costs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;cost&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;iterations (per hundreds)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Learning rate =&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;learning_rate&quot;</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p><img alt="png" src="../output_34_0.png" /></p>
<p>可以看到在每次的迭代过程中，成本值都在降低，说明模型参数正在被学习。</p>
<h3 id="31">3.1 学习率的选择<a class="headerlink" href="#31" title="Permanent link">&para;</a></h3>
<p>在模型参数中有一个“学习率”的概念，学习率决定了模型更新参数的速度，如果学习率设置的过高，模型可能会“超过”最小值，反之，则会造成过慢的收敛速度。
接下来，可以比较一下在你的模型上选用不同学习率时模型的变化。</p>
<div class="highlight"><pre><span></span><code><span class="n">learning_rates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">]</span>
<span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">learning_rates</span><span class="p">:</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;learning rate is: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
    <span class="n">models</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">train_set_x</span><span class="p">,</span> <span class="n">train_set_y</span><span class="p">,</span> <span class="n">test_set_x</span><span class="p">,</span> <span class="n">test_set_y</span><span class="p">,</span> <span class="n">num_iterations</span> <span class="o">=</span> <span class="mi">1500</span><span class="p">,</span> <span class="n">learning_rate</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">print_cost</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s2">&quot;-------------------------------------------------------&quot;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">learning_rates</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">models</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)][</span><span class="s2">&quot;costs&quot;</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">models</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)][</span><span class="s2">&quot;learning_rate&quot;</span><span class="p">]))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;cost&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;iterations&#39;</span><span class="p">)</span>

<span class="n">legend</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper center&#39;</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">frame</span> <span class="o">=</span> <span class="n">legend</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span>
<span class="n">frame</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">&#39;0.90&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="c">learning rate is: 0</span><span class="nt">.</span><span class="c">01</span>
<span class="c">训练集准确性： 99</span><span class="nt">.</span><span class="c">52153110047847 %</span>
<span class="c">测试集准确性： 68</span><span class="nt">.</span><span class="c">0 %</span>

<span class="nb">-------------------------------------------------------</span><span class="c"></span>

<span class="c">learning rate is: 0</span><span class="nt">.</span><span class="c">001</span>
<span class="c">训练集准确性： 88</span><span class="nt">.</span><span class="c">99521531100478 %</span>
<span class="c">测试集准确性： 64</span><span class="nt">.</span><span class="c">0 %</span>

<span class="nb">-------------------------------------------------------</span><span class="c"></span>

<span class="c">learning rate is: 0</span><span class="nt">.</span><span class="c">0001</span>
<span class="c">训练集准确性： 68</span><span class="nt">.</span><span class="c">42105263157895 %</span>
<span class="c">测试集准确性： 36</span><span class="nt">.</span><span class="c">0 %</span>

<span class="nb">-------------------------------------------------------</span><span class="c"></span>
</code></pre></div>

<p><img alt="png" src="../output_36_1.png" /></p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../opencv-learn/" class="md-footer__link md-footer__link--prev" aria-label="Previous: opencv学习" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              opencv学习
            </div>
          </div>
        </a>
      
      
        
        <a href="../regular%20expression/" class="md-footer__link md-footer__link--next" aria-label="Next: 正规方程推导" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              正规方程推导
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.fcfe8b6d.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.b1047164.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>