<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="vllbc">
    <link rel="canonical" href="https://vllbc.github.io/pandas/task2/">
    <link rel="shortcut icon" href="../../1.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>pandas实践2 - Vllbc's home</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "\u6570\u636e\u96c6\u6709\u591a\u5c11\u7537\u6027\u548c\u5973\u6027\uff1f", url: "#_top", children: [
          ]},
          {title: "\u6570\u636e\u96c6\u5973\u6027\u7684\u5e73\u5747\u5e74\u9f84", url: "#_2", children: [
          ]},
          {title: "\u6570\u636e\u96c6\u4e2d\u5fb7\u56fd\u516c\u6c11\u7684\u6bd4\u4f8b\u662f\u591a\u5c11\uff1f", url: "#_3", children: [
          ]},
          {title: "\u5e74\u6536\u5165\u8d85\u8fc7 50K \u548c\u4f4e\u4e8e 50K \u4eba\u7fa4\u5e74\u9f84\u7684\u5e73\u5747\u503c\u548c\u6807\u51c6\u5dee\u662f\u591a\u5c11\uff1f", url: "#50k-50k", children: [
          ]},
          {title: "\u5e74\u6536\u5165\u8d85\u8fc7 50K \u7684\u4eba\u7fa4\u662f\u5426\u90fd\u63a5\u53d7\u8fc7\u9ad8\u4e2d\u4ee5\u4e0a\u6559\u80b2\uff1f", url: "#50k", children: [
          ]},
          {title: "\u4f7f\u7528 groupby \u548c describe \u7edf\u8ba1\u4e0d\u540c\u79cd\u65cf\u548c\u6027\u522b\u4eba\u7fa4\u7684\u5e74\u9f84\u5206\u5e03\u6570\u636e\u3002", url: "#groupby-describe", children: [
          ]},
          {title: "\u7edf\u8ba1\u7537\u6027\u9ad8\u6536\u5165\u4eba\u7fa4\u4e2d\u5df2\u5a5a\u548c\u672a\u5a5a\uff08\u5305\u542b\u79bb\u5a5a\u548c\u5206\u5c45\uff09\u4eba\u7fa4\u5404\u81ea\u6240\u5360\u6570\u91cf\u3002", url: "#_4", children: [
          ]},
          {title: "\u8ba1\u7b97\u5404\u56fd\u8d85\u8fc7\u548c\u4f4e\u4e8e 50K \u4eba\u7fa4\u5404\u81ea\u7684\u5e73\u5747\u5468\u5de5\u4f5c\u65f6\u957f\u3002", url: "#50k_1", children: [
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../pytorch/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../pytorch/" class="btn btn-xs btn-link">
        介绍
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../task1/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../task1/" class="btn btn-xs btn-link">
        pandas实践1
      </a>
    </div>
    
  </div>

    

    <table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>workclass</th>
      <th>fnlwgt</th>
      <th>education</th>
      <th>education-num</th>
      <th>marital-status</th>
      <th>occupation</th>
      <th>relationship</th>
      <th>race</th>
      <th>sex</th>
      <th>capital-gain</th>
      <th>capital-loss</th>
      <th>hours-per-week</th>
      <th>native-country</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>39</td>
      <td>State-gov</td>
      <td>77516</td>
      <td>Bachelors</td>
      <td>13</td>
      <td>Never-married</td>
      <td>Adm-clerical</td>
      <td>Not-in-family</td>
      <td>White</td>
      <td>Male</td>
      <td>2174</td>
      <td>0</td>
      <td>40</td>
      <td>United-States</td>
      <td>&lt;=50K</td>
    </tr>
    <tr>
      <th>1</th>
      <td>50</td>
      <td>Self-emp-not-inc</td>
      <td>83311</td>
      <td>Bachelors</td>
      <td>13</td>
      <td>Married-civ-spouse</td>
      <td>Exec-managerial</td>
      <td>Husband</td>
      <td>White</td>
      <td>Male</td>
      <td>0</td>
      <td>0</td>
      <td>13</td>
      <td>United-States</td>
      <td>&lt;=50K</td>
    </tr>
    <tr>
      <th>2</th>
      <td>38</td>
      <td>Private</td>
      <td>215646</td>
      <td>HS-grad</td>
      <td>9</td>
      <td>Divorced</td>
      <td>Handlers-cleaners</td>
      <td>Not-in-family</td>
      <td>White</td>
      <td>Male</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>United-States</td>
      <td>&lt;=50K</td>
    </tr>
    <tr>
      <th>3</th>
      <td>53</td>
      <td>Private</td>
      <td>234721</td>
      <td>11th</td>
      <td>7</td>
      <td>Married-civ-spouse</td>
      <td>Handlers-cleaners</td>
      <td>Husband</td>
      <td>Black</td>
      <td>Male</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>United-States</td>
      <td>&lt;=50K</td>
    </tr>
    <tr>
      <th>4</th>
      <td>28</td>
      <td>Private</td>
      <td>338409</td>
      <td>Bachelors</td>
      <td>13</td>
      <td>Married-civ-spouse</td>
      <td>Prof-specialty</td>
      <td>Wife</td>
      <td>Black</td>
      <td>Female</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>Cuba</td>
      <td>&lt;=50K</td>
    </tr>
  </tbody>
</table>

<h1 id="_1">数据集有多少男性和女性？</h1>
<pre><code class="python">data['sex'].value_counts()
</code></pre>

<pre><code>Male      21790
Female    10771
Name: sex, dtype: int64
</code></pre>
<h1 id="_2">数据集女性的平均年龄</h1>
<pre><code class="python">data[data['sex'] == 'Female']['age'].mean()
</code></pre>

<pre><code>36.85823043357163
</code></pre>
<h1 id="_3">数据集中德国公民的比例是多少？</h1>
<pre><code class="python">data['native-country'].value_counts(normalize=True)['Germany']
</code></pre>

<pre><code>0.004207487485028101
</code></pre>
<h1 id="50k-50k">年收入超过 50K 和低于 50K 人群年龄的平均值和标准差是多少？</h1>
<pre><code class="python">salary1 = data[data['salary'] == '&gt;50K']['age']
salary2 = data[data['salary'] == '&lt;=50K']['age']
print(salary1.mean(),salary1.std())
print(salary2.mean(),salary2.std())
</code></pre>

<pre><code>44.24984058155847 10.51902771985177
36.78373786407767 14.020088490824813
</code></pre>
<h1 id="50k">年收入超过 50K 的人群是否都接受过高中以上教育？</h1>
<pre><code class="python">data[data['salary'] == &quot;&gt;50K&quot;]['education'].unique()
</code></pre>

<pre><code>array(['HS-grad', 'Masters', 'Bachelors', 'Some-college', 'Assoc-voc',
       'Doctorate', 'Prof-school', 'Assoc-acdm', '7th-8th', '12th',
       '10th', '11th', '9th', '5th-6th', '1st-4th'], dtype=object)
</code></pre>
<h1 id="groupby-describe">使用 groupby 和 describe 统计不同种族和性别人群的年龄分布数据。</h1>
<pre><code class="python">for (race,sex),mini_data in data.groupby(['race','sex']):
    print(race,sex)
    print(mini_data['age'].describe())
</code></pre>

<pre><code>Amer-Indian-Eskimo Female
count    119.000000
mean      37.117647
std       13.114991
min       17.000000
25%       27.000000
50%       36.000000
75%       46.000000
max       80.000000
Name: age, dtype: float64
Amer-Indian-Eskimo Male
count    192.000000
mean      37.208333
std       12.049563
min       17.000000
25%       28.000000
50%       35.000000
75%       45.000000
max       82.000000
Name: age, dtype: float64
Asian-Pac-Islander Female
count    346.000000
mean      35.089595
std       12.300845
min       17.000000
25%       25.000000
50%       33.000000
75%       43.750000
max       75.000000
Name: age, dtype: float64
Asian-Pac-Islander Male
count    693.000000
mean      39.073593
std       12.883944
min       18.000000
25%       29.000000
50%       37.000000
75%       46.000000
max       90.000000
Name: age, dtype: float64
Black Female
count    1555.000000
mean       37.854019
std        12.637197
min        17.000000
25%        28.000000
50%        37.000000
75%        46.000000
max        90.000000
Name: age, dtype: float64
Black Male
count    1569.000000
mean       37.682600
std        12.882612
min        17.000000
25%        27.000000
50%        36.000000
75%        46.000000
max        90.000000
Name: age, dtype: float64
Other Female
count    109.000000
mean      31.678899
std       11.631599
min       17.000000
25%       23.000000
50%       29.000000
75%       39.000000
max       74.000000
Name: age, dtype: float64
Other Male
count    162.000000
mean      34.654321
std       11.355531
min       17.000000
25%       26.000000
50%       32.000000
75%       42.000000
max       77.000000
Name: age, dtype: float64
White Female
count    8642.000000
mean       36.811618
std        14.329093
min        17.000000
25%        25.000000
50%        35.000000
75%        46.000000
max        90.000000
Name: age, dtype: float64
White Male
count    19174.000000
mean        39.652498
std         13.436029
min         17.000000
25%         29.000000
50%         38.000000
75%         49.000000
max         90.000000
Name: age, dtype: float64
</code></pre>
<h1 id="_4">统计男性高收入人群中已婚和未婚（包含离婚和分居）人群各自所占数量。</h1>
<pre><code class="python"># 未婚
data[(data['sex'] == 'Male') &amp;
     (data['marital-status'].isin(['Never-married',
                                   'Separated', 'Divorced']))]['salary'].value_counts()
</code></pre>

<pre><code>&lt;=50K    7423
&gt;50K      658
Name: salary, dtype: int64
</code></pre>
<pre><code class="python"># 已婚
data[(data['sex'] == 'Male') &amp;
     (data['marital-status'].str.startswith('Married'))]['salary'].value_counts()
</code></pre>

<pre><code>&lt;=50K    7576
&gt;50K     5965
Name: salary, dtype: int64
</code></pre>
<h1 id="50k_1">计算各国超过和低于 50K 人群各自的平均周工作时长。</h1>
<pre><code class="python">for (country, salary), sub_df in data.groupby(['native-country', 'salary']):
    print(country, salary, round(sub_df['hours-per-week'].mean(), 2))
</code></pre>

<pre><code>? &lt;=50K 40.16
? &gt;50K 45.55
Cambodia &lt;=50K 41.42
Cambodia &gt;50K 40.0
Canada &lt;=50K 37.91
Canada &gt;50K 45.64
China &lt;=50K 37.38
China &gt;50K 38.9
Columbia &lt;=50K 38.68
Columbia &gt;50K 50.0
Cuba &lt;=50K 37.99
Cuba &gt;50K 42.44
Dominican-Republic &lt;=50K 42.34
Dominican-Republic &gt;50K 47.0
Ecuador &lt;=50K 38.04
Ecuador &gt;50K 48.75
El-Salvador &lt;=50K 36.03
El-Salvador &gt;50K 45.0
England &lt;=50K 40.48
England &gt;50K 44.53
France &lt;=50K 41.06
France &gt;50K 50.75
Germany &lt;=50K 39.14
Germany &gt;50K 44.98
Greece &lt;=50K 41.81
Greece &gt;50K 50.62
Guatemala &lt;=50K 39.36
Guatemala &gt;50K 36.67
Haiti &lt;=50K 36.33
Haiti &gt;50K 42.75
Holand-Netherlands &lt;=50K 40.0
Honduras &lt;=50K 34.33
Honduras &gt;50K 60.0
Hong &lt;=50K 39.14
Hong &gt;50K 45.0
Hungary &lt;=50K 31.3
Hungary &gt;50K 50.0
India &lt;=50K 38.23
India &gt;50K 46.48
Iran &lt;=50K 41.44
Iran &gt;50K 47.5
Ireland &lt;=50K 40.95
Ireland &gt;50K 48.0
Italy &lt;=50K 39.62
Italy &gt;50K 45.4
Jamaica &lt;=50K 38.24
Jamaica &gt;50K 41.1
Japan &lt;=50K 41.0
Japan &gt;50K 47.96
Laos &lt;=50K 40.38
Laos &gt;50K 40.0
Mexico &lt;=50K 40.0
Mexico &gt;50K 46.58
Nicaragua &lt;=50K 36.09
Nicaragua &gt;50K 37.5
Outlying-US(Guam-USVI-etc) &lt;=50K 41.86
Peru &lt;=50K 35.07
Peru &gt;50K 40.0
Philippines &lt;=50K 38.07
Philippines &gt;50K 43.03
Poland &lt;=50K 38.17
Poland &gt;50K 39.0
Portugal &lt;=50K 41.94
Portugal &gt;50K 41.5
Puerto-Rico &lt;=50K 38.47
Puerto-Rico &gt;50K 39.42
Scotland &lt;=50K 39.44
Scotland &gt;50K 46.67
South &lt;=50K 40.16
South &gt;50K 51.44
Taiwan &lt;=50K 33.77
Taiwan &gt;50K 46.8
Thailand &lt;=50K 42.87
Thailand &gt;50K 58.33
Trinadad&amp;Tobago &lt;=50K 37.06
Trinadad&amp;Tobago &gt;50K 40.0
United-States &lt;=50K 38.8
United-States &gt;50K 45.51
Vietnam &lt;=50K 37.19
Vietnam &gt;50K 39.2
Yugoslavia &lt;=50K 41.6
Yugoslavia &gt;50K 49.5
</code></pre>
<pre><code class="python"># 交叉表
pd.crosstab(data['native-country'], data['salary'],
            values=data['hours-per-week'], aggfunc=np.mean)
</code></pre>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>salary</th>
      <th>&lt;=50K</th>
      <th>&gt;50K</th>
    </tr>
    <tr>
      <th>native-country</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>?</th>
      <td>40.164760</td>
      <td>45.547945</td>
    </tr>
    <tr>
      <th>Cambodia</th>
      <td>41.416667</td>
      <td>40.000000</td>
    </tr>
    <tr>
      <th>Canada</th>
      <td>37.914634</td>
      <td>45.641026</td>
    </tr>
    <tr>
      <th>China</th>
      <td>37.381818</td>
      <td>38.900000</td>
    </tr>
    <tr>
      <th>Columbia</th>
      <td>38.684211</td>
      <td>50.000000</td>
    </tr>
    <tr>
      <th>Cuba</th>
      <td>37.985714</td>
      <td>42.440000</td>
    </tr>
    <tr>
      <th>Dominican-Republic</th>
      <td>42.338235</td>
      <td>47.000000</td>
    </tr>
    <tr>
      <th>Ecuador</th>
      <td>38.041667</td>
      <td>48.750000</td>
    </tr>
    <tr>
      <th>El-Salvador</th>
      <td>36.030928</td>
      <td>45.000000</td>
    </tr>
    <tr>
      <th>England</th>
      <td>40.483333</td>
      <td>44.533333</td>
    </tr>
    <tr>
      <th>France</th>
      <td>41.058824</td>
      <td>50.750000</td>
    </tr>
    <tr>
      <th>Germany</th>
      <td>39.139785</td>
      <td>44.977273</td>
    </tr>
    <tr>
      <th>Greece</th>
      <td>41.809524</td>
      <td>50.625000</td>
    </tr>
    <tr>
      <th>Guatemala</th>
      <td>39.360656</td>
      <td>36.666667</td>
    </tr>
    <tr>
      <th>Haiti</th>
      <td>36.325000</td>
      <td>42.750000</td>
    </tr>
    <tr>
      <th>Holand-Netherlands</th>
      <td>40.000000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Honduras</th>
      <td>34.333333</td>
      <td>60.000000</td>
    </tr>
    <tr>
      <th>Hong</th>
      <td>39.142857</td>
      <td>45.000000</td>
    </tr>
    <tr>
      <th>Hungary</th>
      <td>31.300000</td>
      <td>50.000000</td>
    </tr>
    <tr>
      <th>India</th>
      <td>38.233333</td>
      <td>46.475000</td>
    </tr>
    <tr>
      <th>Iran</th>
      <td>41.440000</td>
      <td>47.500000</td>
    </tr>
    <tr>
      <th>Ireland</th>
      <td>40.947368</td>
      <td>48.000000</td>
    </tr>
    <tr>
      <th>Italy</th>
      <td>39.625000</td>
      <td>45.400000</td>
    </tr>
    <tr>
      <th>Jamaica</th>
      <td>38.239437</td>
      <td>41.100000</td>
    </tr>
    <tr>
      <th>Japan</th>
      <td>41.000000</td>
      <td>47.958333</td>
    </tr>
    <tr>
      <th>Laos</th>
      <td>40.375000</td>
      <td>40.000000</td>
    </tr>
    <tr>
      <th>Mexico</th>
      <td>40.003279</td>
      <td>46.575758</td>
    </tr>
    <tr>
      <th>Nicaragua</th>
      <td>36.093750</td>
      <td>37.500000</td>
    </tr>
    <tr>
      <th>Outlying-US(Guam-USVI-etc)</th>
      <td>41.857143</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Peru</th>
      <td>35.068966</td>
      <td>40.000000</td>
    </tr>
    <tr>
      <th>Philippines</th>
      <td>38.065693</td>
      <td>43.032787</td>
    </tr>
    <tr>
      <th>Poland</th>
      <td>38.166667</td>
      <td>39.000000</td>
    </tr>
    <tr>
      <th>Portugal</th>
      <td>41.939394</td>
      <td>41.500000</td>
    </tr>
    <tr>
      <th>Puerto-Rico</th>
      <td>38.470588</td>
      <td>39.416667</td>
    </tr>
    <tr>
      <th>Scotland</th>
      <td>39.444444</td>
      <td>46.666667</td>
    </tr>
    <tr>
      <th>South</th>
      <td>40.156250</td>
      <td>51.437500</td>
    </tr>
    <tr>
      <th>Taiwan</th>
      <td>33.774194</td>
      <td>46.800000</td>
    </tr>
    <tr>
      <th>Thailand</th>
      <td>42.866667</td>
      <td>58.333333</td>
    </tr>
    <tr>
      <th>Trinadad&amp;Tobago</th>
      <td>37.058824</td>
      <td>40.000000</td>
    </tr>
    <tr>
      <th>United-States</th>
      <td>38.799127</td>
      <td>45.505369</td>
    </tr>
    <tr>
      <th>Vietnam</th>
      <td>37.193548</td>
      <td>39.200000</td>
    </tr>
    <tr>
      <th>Yugoslavia</th>
      <td>41.600000</td>
      <td>49.500000</td>
    </tr>
  </tbody>
</table>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../pytorch/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../pytorch/" class="btn btn-xs btn-link">
        介绍
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../task1/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../task1/" class="btn btn-xs btn-link">
        pandas实践1
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content">
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>