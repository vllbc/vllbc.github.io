<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
        <title>å¤§æ¨¡å‹åˆ†å¸ƒå¼ - åˆ†ç±» - vllbc02&#39;s blogs</title>
        <link>https://blog.vllbc.top/categories/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%88%86%E5%B8%83%E5%BC%8F/</link>
        <description>å¤§æ¨¡å‹åˆ†å¸ƒå¼ - åˆ†ç±» - vllbc02&#39;s blogs</description>
        <generator>Hugo -- gohugo.io</generator><language>zh-CN</language><copyright>This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.</copyright><lastBuildDate>Sat, 26 Jul 2025 00:00:00 &#43;0000</lastBuildDate><atom:link href="https://blog.vllbc.top/categories/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%88%86%E5%B8%83%E5%BC%8F/" rel="self" type="application/rss+xml" /><item>
    <title>device_mesh</title>
    <link>https://blog.vllbc.top/device_mesh/</link>
    <pubDate>Sat, 26 Jul 2025 00:00:00 &#43;0000</pubDate>
    <author>vllbc</author>
    <guid>https://blog.vllbc.top/device_mesh/</guid>
    <description><![CDATA[<h2 id="verlä¸­çš„device_mesh">verlä¸­çš„device_mesh</h2>
<p>verlä¸­æœ‰3ä¸ªdevice_meshï¼Œåˆ†åˆ«æ˜¯ï¼š - è®­ç»ƒç”¨çš„FSDP meshï¼ˆé€šå¸¸æ˜¯ä¸€ç»´ï¼‰ -
æ¨ç†ç”¨çš„rollout meshï¼ˆåŒ…å«tpç»´åº¦ï¼‰ - Ulyssesåºåˆ—å¹¶è¡Œçš„meshï¼ˆdpÃ—spï¼‰</p>]]></description>
</item>
<item>
    <title>data_parallel</title>
    <link>https://blog.vllbc.top/data_parallel/</link>
    <pubDate>Wed, 23 Jul 2025 00:00:00 &#43;0000</pubDate>
    <author>vllbc</author>
    <guid>https://blog.vllbc.top/data_parallel/</guid>
    <description><![CDATA[<p>å¦‚æœæƒ³å°†æ¨¡å‹è®­ç»ƒæ‰©å±•åˆ°å¤§çš„æ‰¹æ¬¡ï¼Œåˆ™å¾ˆå¿«å°±ä¼šè¾¾åˆ°åœ¨å•ä¸ª GPU
ä¸Šå¯ä»¥åšçš„æé™ã€‚å…·ä½“æ¥è¯´ï¼Œä¼šå‘ç”Ÿ
<code>RuntimeError: CUDA out of memory</code>ã€‚ <a
href="æ¢¯åº¦ç´¯è®¡.md">æ¢¯åº¦ç´¯è®¡</a>ã€<a
href="Activation%20checkpointing.md">Activation checkpointing</a> å’Œ <a
href="CPU%20offloading.md">CPU offloading</a>
éƒ½å¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šå‡å°‘æ˜¾å­˜çš„å ç”¨ï¼Œä¸ºäº†_æœ‰æ•ˆåœ°_æ‰©å±•åˆ°æ›´å¤§çš„æ¨¡å‹å¤§å°å’Œä¸æ–­å¢é•¿çš„æ•°æ®é›†ï¼ŒåŒæ—¶ä»ç„¶åœ¨åˆç†çš„æ—¶é—´å†…è®­ç»ƒæ¨¡å‹ï¼Œæˆ‘ä»¬éœ€è¦å°†è®¡ç®—<strong>åˆ†å¸ƒåœ¨</strong>ä¸€ç»„æœºå™¨ä¸Šã€‚</p>]]></description>
</item>
<item>
    <title>pipeline parallelism</title>
    <link>https://blog.vllbc.top/pipeline-parallelism/</link>
    <pubDate>Wed, 23 Jul 2025 00:00:00 &#43;0000</pubDate>
    <author>vllbc</author>
    <guid>https://blog.vllbc.top/pipeline-parallelism/</guid>
    <description><![CDATA[<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<ul>
<li><a
href="https://cdn-lfs-us-1.hf.co/repos/e7/07/e7077a163ab0f314cedbb8ddd44667d765205ee536e8b4785fdd0872534107db/274a19a2577ed220cd3a102b4469c44310e4a7c8e8f8ebc36842d907cb51e127?response-content-disposition=inline%3B+filename*%3DUTF-8%27%27The_Ultra-Scale_Playbook_Training_LLMs_on_GPU_Clusters.pdf%3B+filename%3D%22The_Ultra-Scale_Playbook_Training_LLMs_on_GPU_Clusters.pdf%22%3B&amp;response-content-type=application%2Fpdf&amp;Expires=1751735939&amp;Policy=eyJTdGF0ZW1lbnQiOlt7IkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTc1MTczNTkzOX19LCJSZXNvdXJjZSI6Imh0dHBzOi8vY2RuLWxmcy11cy0xLmhmLmNvL3JlcG9zL2U3LzA3L2U3MDc3YTE2M2FiMGYzMTRjZWRiYjhkZGQ0NDY2N2Q3NjUyMDVlZTUzNmU4YjQ3ODVmZGQwODcyNTM0MTA3ZGIvMjc0YTE5YTI1NzdlZDIyMGNkM2ExMDJiNDQ2OWM0NDMxMGU0YTdjOGU4ZjhlYmMzNjg0MmQ5MDdjYjUxZTEyNz9yZXNwb25zZS1jb250ZW50LWRpc3Bvc2l0aW9uPSomcmVzcG9uc2UtY29udGVudC10eXBlPSoifV19&amp;Signature=jer8tObN1q6%7Eij8fX2vLIiox2VNNX0yAD9hjDxq9JXGDmzou6ONo7lnwIlrn%7ECbbaP-BXm80YdFMAgI2SbINgrxMfxLHTkp5IVwqppQ1INlC8K6JrZS3T8QlL4aY5jY7wX7SCUvweSuxEWA2QXMYwHWWV2Iy-OQAMkcdvvxDvjIZZwlYZqJ0tccDbpSYrOhNfkMcGYyxhp3HPgcEd6gVPydQE6g2wM8ErR04u-9dzwkJrIBowWrr8OSD9HJraRyr5XObTaBx3NEADn9De8Zyo%7EknwQs4MDxWSueQCYTlCfFElMF0%7EVMXYh%7EVfDSV5lZZiuxCFfke43Z12VSK5cMV%7EA__&amp;Key-Pair-Id=K24J24Z295AEI9">The
Ultra-Scale Playbook: Training LLMs on GPU Clusters</a></li>
<li><a
href="https://medium.com/huggingface/training-larger-batches-practical-tips-on-1-gpu-multi-gpu-distributed-setups-ec88c3e51255">ğŸ’¥
Training Neural Nets on Larger Batches: Practical Tips for 1-GPU,
Multi-GPU &amp; Distributed setups | by Thomas Wolf | HuggingFace |
Medium</a></li>
<li><a href="https://www.jeremyjordan.me/distributed-training/">Training
extremely large neural networks across thousands of GPUs.</a></li>
</ul>]]></description>
</item>
<item>
    <title>tensor_parallel</title>
    <link>https://blog.vllbc.top/tensor_parallel/</link>
    <pubDate>Wed, 23 Jul 2025 00:00:00 &#43;0000</pubDate>
    <author>vllbc</author>
    <guid>https://blog.vllbc.top/tensor_parallel/</guid>
    <description><![CDATA[<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<ul>
<li><a
href="https://cdn-lfs-us-1.hf.co/repos/e7/07/e7077a163ab0f314cedbb8ddd44667d765205ee536e8b4785fdd0872534107db/274a19a2577ed220cd3a102b4469c44310e4a7c8e8f8ebc36842d907cb51e127?response-content-disposition=inline%3B+filename*%3DUTF-8%27%27The_Ultra-Scale_Playbook_Training_LLMs_on_GPU_Clusters.pdf%3B+filename%3D%22The_Ultra-Scale_Playbook_Training_LLMs_on_GPU_Clusters.pdf%22%3B&amp;response-content-type=application%2Fpdf&amp;Expires=1751735939&amp;Policy=eyJTdGF0ZW1lbnQiOlt7IkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTc1MTczNTkzOX19LCJSZXNvdXJjZSI6Imh0dHBzOi8vY2RuLWxmcy11cy0xLmhmLmNvL3JlcG9zL2U3LzA3L2U3MDc3YTE2M2FiMGYzMTRjZWRiYjhkZGQ0NDY2N2Q3NjUyMDVlZTUzNmU4YjQ3ODVmZGQwODcyNTM0MTA3ZGIvMjc0YTE5YTI1NzdlZDIyMGNkM2ExMDJiNDQ2OWM0NDMxMGU0YTdjOGU4ZjhlYmMzNjg0MmQ5MDdjYjUxZTEyNz9yZXNwb25zZS1jb250ZW50LWRpc3Bvc2l0aW9uPSomcmVzcG9uc2UtY29udGVudC10eXBlPSoifV19&amp;Signature=jer8tObN1q6%7Eij8fX2vLIiox2VNNX0yAD9hjDxq9JXGDmzou6ONo7lnwIlrn%7ECbbaP-BXm80YdFMAgI2SbINgrxMfxLHTkp5IVwqppQ1INlC8K6JrZS3T8QlL4aY5jY7wX7SCUvweSuxEWA2QXMYwHWWV2Iy-OQAMkcdvvxDvjIZZwlYZqJ0tccDbpSYrOhNfkMcGYyxhp3HPgcEd6gVPydQE6g2wM8ErR04u-9dzwkJrIBowWrr8OSD9HJraRyr5XObTaBx3NEADn9De8Zyo%7EknwQs4MDxWSueQCYTlCfFElMF0%7EVMXYh%7EVfDSV5lZZiuxCFfke43Z12VSK5cMV%7EA__&amp;Key-Pair-Id=K24J24Z295AEI9">The
Ultra-Scale Playbook: Training LLMs on GPU Clusters</a></li>
<li><a
href="https://medium.com/huggingface/training-larger-batches-practical-tips-on-1-gpu-multi-gpu-distributed-setups-ec88c3e51255">ğŸ’¥
Training Neural Nets on Larger Batches: Practical Tips for 1-GPU,
Multi-GPU &amp; Distributed setups | by Thomas Wolf | HuggingFace |
Medium</a></li>
<li><a href="https://www.jeremyjordan.me/distributed-training/">Training
extremely large neural networks across thousands of GPUs.</a></li>
</ul>]]></description>
</item>
<item>
    <title>zero</title>
    <link>https://blog.vllbc.top/zero/</link>
    <pubDate>Tue, 22 Jul 2025 00:00:00 &#43;0000</pubDate>
    <author>vllbc</author>
    <guid>https://blog.vllbc.top/zero/</guid>
    <description><![CDATA[<p>åˆ†ä¸ºzero1ã€zero2ã€zero3ï¼Œè™½ç„¶zero3å¯¹æ¨¡å‹è¿›è¡Œäº†åˆ†å‰²ï¼Œä½†æ˜¯æœ¬è´¨ä¸Šè¿˜æ˜¯å±äºæ•°æ®å¹¶è¡Œï¼Œå› ä¸ºåœ¨å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­éœ€è¦all-gatheræ¨¡å‹å‚æ•°ï¼Œéœ€è¦å®Œæ•´çš„æ¨¡å‹æƒé‡ã€‚</p>]]></description>
</item>
<item>
    <title>ring-all-reduce</title>
    <link>https://blog.vllbc.top/ring-all-reduce/</link>
    <pubDate>Thu, 17 Jul 2025 00:00:00 &#43;0000</pubDate>
    <author>vllbc</author>
    <guid>https://blog.vllbc.top/ring-all-reduce/</guid>
    <description><![CDATA[<p>All-reduced=all-gather+reduce-scatter</p>
<ul>
<li><strong>All-Gather</strong>Â ï¼šå°†åˆ†å¸ƒå¼æ•°æ®æ±‡æ€»åˆ°æ‰€æœ‰èŠ‚ç‚¹ï¼Œé€‚ç”¨äºéœ€è¦<strong>å…¨å±€æ•°æ®</strong>åŒæ­¥çš„åœºæ™¯ã€‚</li>
<li><strong>Reduce-Scatter</strong>ï¼šå°†åˆ†å¸ƒå¼æ•°æ®è¿›è¡Œ<strong>è§„çº¦</strong>å¹¶<strong>åˆ†æ•£</strong>åˆ°æ‰€æœ‰èŠ‚ç‚¹ï¼Œé€‚ç”¨äºéœ€è¦å±€éƒ¨ç»“æœåˆ†å‘çš„åœºæ™¯ã€‚</li>
<li><strong>All-Reduce</strong>Â ï¼š Reduce-Scatter å’Œ All-Gather
çš„ç»„åˆã€‚</li>
</ul>
<h2 id="all-gather">All-gather</h2>
<p><strong>æ ¸å¿ƒåŠŸèƒ½</strong>ï¼šå°†æ¯ä¸ªèŠ‚ç‚¹çš„éƒ¨åˆ†æ•°æ®æ±‡æ€»åˆ°æ‰€æœ‰èŠ‚ç‚¹ï¼Œæœ€ç»ˆæ‰€æœ‰èŠ‚ç‚¹æ‹¥æœ‰<strong>å®Œæ•´æ•°æ®</strong>å‰¯æœ¬ã€‚<br />
<strong>é€‚ç”¨åœºæ™¯</strong>ï¼šæ¨¡å‹å¹¶è¡Œä¸­çš„å‚æ•°åŒæ­¥ã€å…¨å±€ç»Ÿè®¡ä¿¡æ¯èšåˆã€‚</p>]]></description>
</item>
<item>
    <title>ulysses_sequence_parallel</title>
    <link>https://blog.vllbc.top/ulysses_sequence_parallel/</link>
    <pubDate>Tue, 08 Jul 2025 00:00:00 &#43;0000</pubDate>
    <author>vllbc</author>
    <guid>https://blog.vllbc.top/ulysses_sequence_parallel/</guid>
    <description><![CDATA[<p>ä¸€å¥è¯ï¼šåœ¨sequenceç»´åº¦ä¸Šè¿›è¡Œåˆ‡åˆ†</p>
<ul>
<li>å°†è¾“å…¥åºåˆ— X (é•¿åº¦ N) æ²¿åºåˆ—ç»´åº¦åˆ‡åˆ†ä¸º SP å—ï¼Œæ¯ä¸ª GPU åˆ†é…åˆ° N/SP
é•¿åº¦çš„å­åºåˆ—ã€‚
<ul>
<li>å¯¹äºéæ³¨æ„åŠ›å±‚ (å¦‚ MLP)ï¼Œè®¡ç®—æ˜¯å®Œå…¨å±€éƒ¨çš„ï¼Œæ¯ä¸ª GPU
å¤„ç†è‡ªå·±çš„å­åºåˆ—å³å¯ã€‚
<ul>
<li>token ä¹‹é—´ç‹¬ç«‹ï¼Œtoken-level projection</li>
<li>Ulysses
SPçš„æ ¸å¿ƒå¤æ‚æ€§åœ¨äºAttentionå±‚ã€‚ä¸ºäº†è®©æ¯ä¸ªtokenåœ¨è®¡ç®—æ³¨æ„åŠ›æ—¶èƒ½å¤Ÿè€ƒè™‘åˆ°å…¨å±€åºåˆ—ä¿¡æ¯ï¼ˆæˆ–è€…è¯´ï¼Œè®©æ¯ä¸ªheadåœ¨è®¡ç®—æ—¶èƒ½çœ‹åˆ°å®Œæ•´çš„åºåˆ—ï¼Œå³ä½¿è¿™ä¸ªheadåªåœ¨å½“å‰rankè®¡ç®—ï¼‰ï¼ŒAttentionæ¨¡å—å‰åéœ€è¦è¿›è¡Œä¸¤æ¬¡ç²¾å¯†çš„all-to-allæ•°æ®é‡æ’ã€‚MLPå±‚åˆ™æ²¡æœ‰è¿™æ ·çš„éœ€æ±‚ï¼Œæ•°æ®åœ¨è¿›å…¥MLPæ—¶å·²ç»æ˜¯æŒ‰åºåˆ—åˆ†ç‰‡å¥½çš„ï¼Œå¯ä»¥ç›´æ¥è¿›è¡Œæœ¬åœ°è®¡ç®—ã€‚</li>
</ul></li>
<li>å¯¹äºæ³¨æ„åŠ›å±‚:
<ul>
<li>æ­¥éª¤ 1 (è®¡ç®— Q, K, V): æ¯ä¸ª GPU åŸºäºå…¶æœ¬åœ°å­åºåˆ—è®¡ç®—å‡ºæœ¬åœ°çš„
Q_local, K_local, V_local (ç»´åº¦çº¦ä¸º N/SP x dï¼Œd æ˜¯éšè—ç»´åº¦)ã€‚</li>
<li>æ­¥éª¤ 2 (å…¨å±€ K, V æ”¶é›† - å…³é”®):
ä½¿ç”¨Â <strong>All-to-All</strong>Â é€šä¿¡æ“ä½œï¼ˆAll-Gather??ï¼‰ã€‚æ¯ä¸ª GPU
å°†è‡ªå·±çš„ K_local, V_local å‘é€ç»™æ‰€æœ‰å…¶ä»– GPUï¼Œå¹¶æ¥æ”¶æ¥è‡ªæ‰€æœ‰å…¶ä»– GPU çš„
K, V å—ã€‚æ‰§è¡Œåï¼Œ<strong>æ¯ä¸ª GPU æ‹¥æœ‰å®Œæ•´çš„å…¨å±€ K å’Œ V çŸ©é˜µ (ç»´åº¦ N x
d)</strong>ï¼Œä½†ä»ç„¶åªæ‹¥æœ‰æœ¬åœ°çš„ Q_local (ç»´åº¦ N/SP x d)ã€‚
<ul>
<li><a
href="https://docs.nvidia.com/deeplearning/nccl/user-guide/docs/usage/collectives.html">https://docs.nvidia.com/deeplearning/nccl/user-guide/docs/usage/collectives.html</a></li>
</ul></li>
<li>æ­¥éª¤ 3 (æœ¬åœ°æ³¨æ„åŠ›è®¡ç®—): æ¯ä¸ª GPU ä½¿ç”¨å…¶ Q_local å’Œå®Œæ•´çš„å…¨å±€ K, V
è®¡ç®—å…¶è´Ÿè´£çš„é‚£éƒ¨åˆ†æ³¨æ„åŠ›è¾“å‡º O_local (ç»´åº¦ N/SP x d)ã€‚è®¡ç®—å…¬å¼ä¸º
Attention(Q_local, K_global, V_global)ã€‚è¿™ä¸€æ­¥çš„è®¡ç®—é‡æ˜¯ (N/SP) * N *
dï¼Œå†…å­˜ç“¶é¢ˆåœ¨äºå­˜å‚¨ä¸´æ—¶çš„æ³¨æ„åŠ›åˆ†æ•°çŸ©é˜µï¼Œå¤§å°çº¦ä¸ºÂ <strong>(N/SP) *
N</strong>ã€‚ç›¸æ¯”åŸå§‹çš„Â **N*N**ï¼Œå†…å­˜æ˜¾è‘—é™ä½ã€‚</li>
<li>æ­¥éª¤ 4 (å¯é€‰çš„è¾“å‡ºé‡ç»„):
å¦‚æœåç»­å±‚éœ€è¦æŒ‰åºåˆ—æ‹¼æ¥çš„å®Œæ•´è¾“å‡ºï¼Œå¯èƒ½éœ€è¦å¦ä¸€æ¬¡é€šä¿¡ï¼ˆå¦‚ All-Gather
æˆ–å¦ä¸€æ¬¡ All-to-All çš„å˜ç§ï¼‰æ¥ç»„åˆ O_localã€‚ä½†åœ¨ DeepSpeed
å®ç°ä¸­ï¼Œé€šå¸¸ä¿æŒåˆ†å¸ƒå¼çŠ¶æ€ï¼Œç›´æ¥è¾“å…¥åˆ°ä¸‹ä¸€ä¸ªåŒæ ·æŒ‰åºåˆ—å¹¶è¡Œçš„å±‚ã€‚</li>
</ul></li>
</ul></li>
</ul>
<h2 id="verlä¸­çš„åºåˆ—å¹¶è¡Œ">verlä¸­çš„åºåˆ—å¹¶è¡Œ</h2>
<p>åœ¨verlä¸­ï¼Œä¸€èˆ¬ä¸remove_paddingä¸€èµ·ä½¿ç”¨ï¼Œå³</p>]]></description>
</item>
<item>
    <title>fsdp</title>
    <link>https://blog.vllbc.top/fsdp/</link>
    <pubDate>Sun, 06 Jul 2025 00:00:00 &#43;0000</pubDate>
    <author>vllbc</author>
    <guid>https://blog.vllbc.top/fsdp/</guid>
    <description><![CDATA[<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<p><a href="https://zhuanlan.zhihu.com/p/1929115059113693341">RL
ç³»ç»Ÿæ·±æ€ï¼šFSDP è®­ç»ƒåç«¯</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/694288870">PyTorch FSDP
è®¾è®¡è§£è¯»</a></p>]]></description>
</item>
</channel>
</rss>
